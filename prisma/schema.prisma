// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

enum UserType {
    USER 
    DRIVER
}

model User {
    id            String            @id
    username      String            @unique 
    email         String            @unique
    password      String
    name          String
    lastname      String 
    phoneNumber   String            @unique
    idCard        String            @unique
    userType      UserType
    driverId      String?           @unique
    sessions      Session[]
    Driver        Driver?           @relation(fields: [driverId], references: [id], onDelete: Cascade)
    Feedback      Feedback[]  
}

model Driver {
    id              String          @id @default(cuid())
    User            User?
    license         DrivingLicense  @relation(fields: [licenseNumber], references: [licenseId], onDelete: Cascade)
    licenseNumber   String          @unique
    Car             Car[]
    trips           Trip[]
}

model DrivingLicense{
    licenseId     String      @id
    expiration    DateTime
    Driver        Driver?
}

model Car {
    licensePlate  String           @id
    model         String 
    Driver        Driver           @relation(fields: [driverId], references: [id])
    driverId      String           @unique
}

model Trip {
    id                String        @id @default(cuid())
    departureCity     String
    destinationCity   String
    departureDate      String
    departureHour     String
    price             Decimal
    estimatedTime     String
    driverId          String
    Driver            Driver?       @relation(fields: [driverId], references: [id])
}

model Feedback {
    id      String                  @id
    rating  String   
    User    User?                   @relation(fields: [userId], references: [id])
    userId  String?
}

model Session {
  id        String   @id
  userId    String
  expiresAt DateTime
  user      User     @relation(references: [id], fields: [userId], onDelete: Cascade)
}